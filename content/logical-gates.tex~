\chapter{Logical gates with polarization-encoded single x-rays}
\label{chap:logical-gates}


Due to the exponentially increasing computation complexity over the years, the number of transistors per chip growths continuously, becoming technically more and more demanding. It is therefore a crucial objective of information technology to build computing devices (classical as well as quantum mechanical) in a more and more compact form. Photons, for instance, can be used as flying information carriers which enable fast and efficient information processing schemes sustainable over long distances. However, applying Moore's law \cite{Moore1998} to photonic circuits, it turns out that the size of future devices will be quickly limited by the diffraction limit of the used photons ($\sim \mu$m for optical wavelengths). The usage of x-ray photons would drastically reduce the fundamental limitation on nanoscale photonic circuits because of the remarkable focusing abilities in the keV photonic energy range. Currently, x-ray beams have been focused down to the nm range \cite{Mimura2010.NP, Huang2013.SR, Shapiro2014.NP}, and today's x-ray waveguides typically employ a spatial confinement between ten up to tens of nm \cite{Kruger2012-waveguide}. The potential sub-\r{A} spatial resolution of x-rays \cite{Doring2013.OE} promotes the vision of future information storage and processing schemes in their most compact form, namely on the scale of single atoms.

While atomic transitions are naturally used to resonantly manipulate optical photons, nuclear transitions may be the elementary counterparts for x-rays. 
For quantum optics applications, nuclear transitions present a clean, well isolated system with very long coherence times, while x-rays attract with their good detection efficiency, penetration power and spatial resolution.
Admittedly, experimental challenges at the large coherent x-ray source facilities today will require a different paradigm compared to table-top optical experiments. However,  control at the single-photon level has been recently demonstrated also in a laboratory-scale M\"ossbauer setup, where  the coherent manipulation of  waveforms of individual x-rays has been achieved \cite{Vagizov2014}. Such control procedures operated at single-photon nuclear interfaces along with the recent development in x-ray optics \cite{Shvydko2003.PRL, Chang2005.PRL, Chen2008.APL, Shvydko2010.NP, Shvydko2011.NP, Osaka2013.OE, Shvydko-book} open the perspective to extend fields like quantum information and quantum communication to photon energies in the keV-range. 

The extension of information science to x-ray wavelengths requires precise control tools not only for the waveforms, but also for polarization, frequency and phase of single-photon wave packets. 
In this Chapter, we concentrate on the polarization properties of x-ray photons. We investigate theoretically how polarization-encoded single x-rays can be coherently processed by means of resonant nuclear interactions via the procedure introduced in Chap.~\ref{chap:pol-control}. The main result of this Chapter is the design of logical gates for single x-ray photons. The platform where it is possible to integrate unary logical operations for x-rays within a single setup is introduced right at the beginning in Sec.~\ref{sec:gates-setup}.
%The setup together with experimental settings and limitations is discussed right at the beginning in Sec.~\ref{sec:gates-setup}. 
Afterwards, in Sec.~\ref{sec:unary-gates} it is explicitly shown how the single-input logical gates can be implemented on this platform by polarization control schemes employing magnetic field rotations. Sec.~\ref{sec:binary-gates} is finally devoted to binary logical operations. Introducing a second, temporally synchronized control photon opens the possibility to put forward Boolean operations with x-rays.




%------------------------------------------------------------------------------------%
\section{The universal platform for single x-ray manipulations}
\label{sec:gates-setup}

\begin{figure}%
\centering
\includegraphics[width=0.6\linewidth]{pics/setup-gates.pdf}%
\caption{Nuclear forward scattering setup. $\sigma$- (orange) or $\pi$-polarized (blue) x-rays scatter off a nuclear target in the forward direction. A
spatially separated control photon triggers a magnetic field rotation from the $z$- to the $x$-axis. The hyperfine-split nuclear level scheme of $^{57}$Fe is illustrated in the inset.}%
\label{fig:gates-setup}%
\end{figure}

Analogously to Chaps.~\ref{chap:NFS} and \ref{chap:pol-control}, the setup of nuclear resonant scattering is considered (see Fig.~\ref{fig:gates-setup}). A broadband x-ray pulse resonant to the 14.4 keV M\"{o}ssbauer transition in ${}^{57}$Fe impinges on an iron target.
% in the presence of a hyperfine magnetic field. 
In the presence of a nuclear hyperfine magnetic field, the ground and excited nuclear states of ${}^{57}$Fe undergo Zeeman splitting according to their spin values as illustrated in the inset of Fig.~\ref{fig:gates-setup}. Due to the Fourier limit of the temporally narrow incident x-ray pulses, several polarization-selected hyperfine transitions labeled with $\ell$ can be simultaneously driven  leading to well-known quantum beats in the NFS intensity spectrum \cite{NFS-bible}. For instance, initially $\sigma$-($\pi$-)polarized x-rays couple to all $\Delta M=0$ ($\Delta M=\pm1$) transitions provided the magnetic field $\bm{B}_{\rm{I}}$ points along the $z$-direction. Since only those photons are coherently scattered into the forward direction for which the nucleus returns  to its original ground state Zeeman level, the $\sigma$-($\pi$-)polarization is conserved in the course of NFS with constant hyperfine field $\bm{B}_{\mathrm{I}}$ as explained in Sec.~\ref{sec:pol-static}.

Abrupt rotations of the nuclear hyperfine magnetic field offer means of polarization control of the nuclear signal as shown in Secs.~\ref{sec:pol-control} and \ref{sec:beyond-first-order}.  The magnetic field at the nuclear target  $\bm{B}_{\mathrm{I}}$ is initially assumed to be constant and to point along the $z$-axis. A fast rotation of the magnetic field following nuclear excitation (for instance, to $\bm{B}_{\mathrm{II}}$ parallel to the $x$-axis by a 90${}^{\circ}$ counterclockwise rotation around the $y$-direction) leads to an almost instantaneous change of the quantization axis and a redistribution of the collective excitation among the Zeeman levels. Each initially excited nuclear current \cite{Shvydko1999.PRB, Adriana2010.JoMO} is transferred into a sextet of new currents which can interfere constructively or destructively depending on the switching geometry and exact rotation moment $\tau_0$ \cite{Shvydko1996.PRL}. 

We consider ${}^{57}$Fe-enriched FeBO${}_3$ as target which is a canted antiferromagnet. The FeBO${}_3$ crystal attracts with a very pure nuclear signal \cite{Smirnov2000.HI} and excellent switching properties of the magnetic field. Practically, a constant, weak magnetic field first induces a magnetization of the nuclear spins. Applying a second, pulsed magnetic field (stronger than the constant B-field) leads to a fast realignment of the hyperfine fields while keeping the nuclear magnetic moment unchanged. Experimentally the timescale of such abrupt rotations has been reported to be faster than 4~ns \cite{Shvydko1994.EPL} due to the special magnetization properties of FeBO${}_3$. In the following, we will consider an effective target thickness of $\xi=10$.
% corresponding to a ...$\mu$m thick crystal enriched in ${}^{57}$Fe to ...\%.

At present, typically in x-ray-nuclear-transition interfaces  only one excitation, i.e., one resonant x-ray photon, exists in the system at any given time \cite{Roehlsberger2004}. The photon is  in a coherent state rather than a Fock state, allowing for a semi-classical treatment of the light-nucleus interaction \cite{ScullyZubairy} as introduced in Chaps.~\ref{chap:NFS} and \ref{chap:pol-control}.  Entanglement  occurs in the system only in its single-photon version \cite{Lee2000, Adriana2009.PRL}, by having the x-ray photon entangle two spatially or temporally separated field modes. Furthermore, in contrast to nuclear magnetic resonance techniques \cite{NielsenChuang2000} that employ nuclear ground state spins as information carriers and process them with microwave fields, here we envisage magnetic fields to modify the properties of an x-ray transition to an excited nuclear state. These are rather unusual factors for the implementation of logical operations as known from the optical  \cite{Jaksch2000.PRL,Calarco2000.PRA,Calarco2003.PRA,Hammerer2010.review,Halfmann2011.PRA} or microwave regimes \cite{Cory1997.NMR, Gershenfeld1997.NMR,Wunderlich2001.PRL,Wunderlich2011.Nature}, that call for a new approach.


%------------------------------------------------------------------------------------%
\section{Unary logical operations}
\label{sec:unary-gates}

Classically, there are four single-input, i.e, unary, logic gates: the \textsc{Identity} leaves the target bit unchanged; the \textsc{True} and \textsc{False} operations give ``T'' and ``F'', respectively, independent of the input; and the \textsc{Negation} flips the operated bit from either ``F'' to ``T'' or from ``T'' to ``F'' (see truth tables in Fig.~\ref{fig:gates-tables}).  The photonic information carriers can be encoded as x-ray orthogonal polarization states, for instance  ``F'' as $\pi$- and ``T'' as $\sigma$-polarization.  The unary gates for polarization-encoded x-rays can be implemented in resonant NFS by making use of the polarization control scheme introduced in Chap.~\ref{chap:pol-control}. There it has been shown that linear polarizations states can be converted into their orthogonal counterparts by applying a timed $90^{\circ}$-rotation (from $z$ to $x$) of the magnetic field as schematically illustrated in Fig.~\ref{fig:current-redistribution}. In order to realize logical operations within this setup, switching instances $\tau_0$ have to be found where $\sigma$- and $\pi$-polarizations are simultaneously converted into (pure) opposite polarization states.

Let us discuss the finding of these switching instants $\tau_0$ at the example of the \textsc{Negation}. In this case, the moment of switching has to be chosen such that initially $\sigma$- and initially $\pi$-polarized x-rays are scattered into $\pi$- and $\sigma$-polarization states, respectively. This requirement translates to finding an instance $\tau_0$ where the amplitudes $\bm{\mathcal{A}}_{\ell=\pm1,\pm3,\mathrm{II}}$ for $\bm{e}_{\rm{p}}=\bm{e}_{\sigma}$ and $\bm{\mathcal{A}}_{\ell=\pm2,\mathrm{II}}$ for $\bm{e}_{\rm{p}}=\bm{e}_{\pi}$ identically vanish at the same time. Numerically evaluating Eq.~\eqref{eq:amplitude-beyond_0}, we can prove that such almost simultaneous switching times exist leading to the desired behavior for $\bm{E}_0$ for times $\tau>\tau_0$ [see Eq.~\eqref{eq:field-beyond_0}]. Following this procedure for the \textsc{Identity}, \textsc{True} and \textsc{False} operations, the unary x-ray gates can be implemented within the same setup by choosing the proper $\tau_0$ \cite{Jonas2015-gates-arxiv}. 


\captionsetup[subfigure]{position=top}
\begin{figure}%
\centering
\subfloat[Unary logical gates in the course of NFS]{\label{fig:gates-spectra}\includegraphics[width=0.75\linewidth]{pics/log-gates-new.eps}}\\%
%\hspace{10pt}%
\subfloat[Truth tables for \textsc{Identity}, \textsc{False}, \textsc{True} and \textsc{Negation}.]{\label{fig:gates-tables}
\begin{tabular}{ccp{0.25cm}ccp{0.25cm}ccp{0.25cm}cc}
\rowcolor{back} \textcolor{fore}{\textsc{In}} & \textcolor{fore}{\textsc{Out}} & \cellcolor{white} & \textcolor{fore}{\textsc{In}} & \textcolor{fore}{\textsc{Out}} & \cellcolor{white} & \textcolor{fore}{\textsc{In}} & \textcolor{fore}{\textsc{Out}} & \cellcolor{white} & \textcolor{fore}{\textsc{In}} & \textcolor{fore}{\textsc{Out}} \\ 
\rowcolor{fore} \textcolor{back}{F} & \textcolor{back}{F} & \cellcolor{white} & \textcolor{back}{F} & \textcolor{back}{F} & \cellcolor{white} & \textcolor{back}{F} & \textcolor{back}{T} & \cellcolor{white} & \textcolor{back}{F} & \textcolor{back}{T}  \\
\rowcolor{fore} \textcolor{back}{T} & \textcolor{back}{T} & \cellcolor{white} & \textcolor{back}{T} & \textcolor{back}{F} & \cellcolor{white} & \textcolor{back}{T} & \textcolor{back}{T} & \cellcolor{white} & \textcolor{back}{T} & \textcolor{back}{F}
\end{tabular}
}%
%\hspace{10pt}%
%\subfloat[Time delay]{\label{fig:time}\includegraphics[width=0.36\linewidth]{pics/time-delay.eps}}%
%\hspace{12pt}%
%\subfloat[Spatial splitting]{\label{fig:spatial}\includegraphics[width=0.36\linewidth]{pics/spatial-splitting.eps}}%
\caption{(a) NFS intensity spectra with an optical depth of $\xi$=10 are shown for initially $\sigma$- (top row) and $\pi-$polarized (bottom row) x-rays. The switching times $\tau_0$ (red dashed lines) determine the implemented logical operation. (b) Truth tables for the logical \textsc{Identity}, \textsc{False}, \textsc{True} and \textsc{Negation} are presented.}
\label{fig:unary-gates}
\end{figure}


Our results are presented in Fig.~\ref{fig:unary-gates}. In the top row the incident radiation is $\sigma$-polarized (orange line and filling) whereas the bottom row shows the scattered photon yield for initially $\pi$-polarized x-rays (blue line and filling).
The numerical results for the scattered field shown in Fig.~\ref{fig:gates-spectra} include all scattering orders up to $p_{\rm{max}}=14$ which is sufficient for an effective target thickness of $\xi=10$. 
Fig.~\ref{fig:unary-gates} shows that depending on the moments of magnetic field rotation, it is possible to convert orthogonal polarizations into each other in the course of NFS. For instance, a magnetic field rotation of $90^{\circ}$ at $\tau\approx 22.3$~ns simultaneously converts $\sigma$ into $\pi$ and vice versa as shown in the last column of Fig.~\ref{fig:gates-spectra}, successfully implementing the logical \textsc{Negation} for all times $\tau>\tau_0$. In the same manner, it is also possible to realize the \textsc{True}, \textsc{False} and \textsc{Identity} operations. The latter does not need any switching of the magnetic field  since the chosen geometry conserves $\sigma$- and $\pi$-polarization in the case of static hyperfine fields.

In order to quantify the success rate of the implemented x-ray gates, the measures $\varepsilon$ and $\eta$ are introduced via
%
\begin{equation}
\varepsilon = \frac{\int_{0}^{\tau_0} \d\tau \, \big| \bm{E}(\xi,\tau) \big|^2}{\int_{0}^{\infty}\d\tau \, \big| \bm{E}(\xi,\tau) \big|^2} = \frac{I_{\tau<\tau_0}}{I_{\rm{tot}}} \ ,
\label{eq:epsilon}
\end{equation} 
%
and
%
\begin{equation}
\eta = \frac{\int_{\tau_0}^{\infty} \d\tau \, \big| \bm{E}_{\rm{gate}}(\xi,\tau) \big|^2}{\int_{\tau_0}^{\infty}\d\tau \, \big| \bm{E}(\xi,\tau) \big|^2} = \frac{I_{\rm{gate}}}{I_{\tau>\tau_0}} \ .
\label{eq:eta}
\end{equation} 
%
The quantity $\varepsilon$ is defined as the integrated intensity for times smaller than the moment of switching $I_{\tau<\tau_0}$ divided by the total integrated intensity $I_{\rm{tot}}$. Since the gate operation can be only realized for $\tau>\tau_0$, $\varepsilon$ gives a measure of the intensity loss at times $\tau<\tau_0$. Due to multiple scattering events, the scattered radiation field after $\tau_0$ also contains distortions from the ``wrong'' polarization output. The quantity $\eta$ describes the probability of realization for the x-ray gates for times $\tau>\tau_0$. In Eq.~\eqref{eq:eta}, $\bm{E}_{\rm{gate}}$ corresponds to the polarization component of a successful gate operation, e.g., in the case of the \textsc{True}: $\bm{E}_{\rm{gate}}=\bm{E}\cdot \bm{e}_{\sigma}$. 

\renewcommand{\arraystretch}{1.2}
\begin{table}
  \small
  \centering
  \begin{tabular}{lcccc}
  \hline\hline
  & & & & \tabularnewline[-0.4cm]
  & \textsc{Identity} & \textsc{False} & \textsc{True}  & \textsc{Negation}  \tabularnewline 
  & & & & \tabularnewline[-0.4cm] \hline
  & & & & \tabularnewline[-0.4cm]
  $\epsilon^{\sigma}$ (\%) & 0 & 95.2 & 93.5 (92.9) & 87.4  \tabularnewline
  $\epsilon^{\pi}$ (\%) & 0 & 92.5 & 82.9 & 73.6 \tabularnewline
  $\eta^{\sigma}$ (\%) & 100 & 97.0 & 98.3 (99.2) & 95.9 \tabularnewline
  $\eta^{\pi}$ (\%) & 100 & 99.4 & 99.9 & 99.3 \tabularnewline
  & & & & \tabularnewline[-0.4cm] \hline\hline
  \end{tabular}
  \caption{Loss rate $\varepsilon$ and probability of realization $\eta$ are presented for the case of optimized switching moments as used in Fig.~\ref{fig:unary-gates}. Superscripts $\sigma$ and $\pi$ refer to initial polarization state of the incoming radiation.}
  \label{table:prob-realization}
\end{table}
\renewcommand{\arraystretch}{1}


In Table \ref{table:prob-realization}, numerical values $\varepsilon$ and $\eta$ are presented for the realizations shown in Fig.~\ref{fig:unary-gates} in dependence of the initial polarization state. Since the \textsc{Identity} operation is accomplished without any switching, it attracts with no loss and a success rate of 100\%. The non-trivial cases, the \textsc{False}, \textsc{True} and \textsc{Negation}, in particular suffer from high loss rates, larger than 70\%. The probabilities of realization $\eta$ for $\tau>\tau_0$ approach values close to unity. Even in the case of the \textsc{Negation} for initially $\sigma$-polarized x-rays which represents the worst scenario in terms of $\eta$, a success rate of $95.9\%$ is reached.

In general, the polarization purity of the scattered radiation after the magnetic field switching is limited by three factors.  First, in our choice of $\tau_0$ we rely on Eq.~(\ref{eq:amplitude-beyond_0}) in which we have disregarded the possibility of further multiple scattering after the magnetic field switching at $\tau_0$. This approximation leads to small polarization mixing in the case of $\xi=10$ as shown by the complete numerical calculation, see Fig.~\ref{fig:gates-spectra}. Thereby, the unwanted polarization component contributes less than 5\% to the total intensity after $\tau_0$, see Table \ref{table:prob-realization}.
Second, theoretically the switching times for an individual unary gate may differ by up to 0.5 ns depending on whether the incident radiation is $\sigma$- or $\pi$ polarized. For instance, in the case of the \textsc{Negation} unary gate, $\tau_0^{\sigma}=22.6$~ns and  $\tau_0^{\pi}=22.1$~ns [these are the values used in Fig.~\ref{fig:gates-spectra}]. Even if we choose an averaged switching time in between, the calculated probability of realization $\eta$ is still better than 95\% for all four unary gates. 
Third, so far experimentally the switching time is known only to be less than 4 ns \cite{Shvydko1994.EPL} for a setup employing $^{57}$Fe-enriched FeBO${}_3$ \cite{vanBurck1987.PRL,Smirnov1983.JETP}. However, the good performance of switching experiments \cite{Shvydko1994.HI,Shvydko1996.PRL} indicates that the magnetic field rotation occurs on a shorter time than 4~ns. Already a rotation duration of 1 ns, leading to 1 ns uncertainty of $\tau_0$ corresponds to $\eta=90\%$ for the most affected case of the \textsc{Negation} gate, motivating thus improvements in the experimental determination and control of the fast switching instant $\tau_0$. 

Beside perturbations from the ``wrong'' polarization component, the condition $\tau>\tau_0$ strongly reduces the total probabilities of realization, since photons released before the time $\tau_0$ defined by the vertical dashed line in Fig.~\ref{fig:gates-spectra} are lost. Rotations at late times therefore lead inevitably to significant losses $\varepsilon$, in the case of the logical \textsc{Negation}, for instance, in average more than 80\% of the scattered photons. In the following we introduce two approaches that circumvent some of the depicted limitations.


\captionsetup[subfigure]{position=top}
\begin{figure}%
\centering
\subfloat[Time delay]{\label{fig:time}\includegraphics[width=0.36\linewidth]{pics/time-delay.eps}}%
\hspace{12pt}%
\subfloat[Spatial splitting]{\label{fig:spatial}\includegraphics[width=0.36\linewidth]{pics/spatial-splitting.eps}}%
\caption{The initial x-ray pulse can be temporally (a) or spatially (b) split  depending on its polarization.}
\label{fig:splitting}
\end{figure}


A first approach is to introduce a polarization-sensitive time delay line by using a polarizer as shown in Fig.~\subref*{fig:time}.  The instant of nuclear excitation becomes then dependent on the polarization of the incident SR pulse. Since the polarization is assumed to be either $\sigma$ or $\pi$ initially, the time delay can be chosen such that the two switching times exactly match and losses are minimized. For instance, in order to implement the logical \textsc{Negation} via a switching time of 6.9 ns, the $\pi$-polarization needs to be delayed by 1.9 ns which reduces the losses from approx. 80\% to approx. 38\% in the case of initially $\pi$-polarized light. Practically, such a time delay line \cite{roling2012,osaka2014} can be realized with modern x-ray optics like channel-cut silicon crystals as polarizers \cite{Toellner1995.polarizer, Marx2011.polarizer, Marx2013.polarizer} and almost 100\% reflecting x-ray mirrors \cite{Shvydko2010.NP}. In Refs.~\cite{Roseker2011.time-delay, Roseker2013.time-delay}, for instance, 8 keV photons have been temporally delayed up to 3 ns. 

Similarly, in a second approach the polarizer can be used to spatially split the SR pulse in order to use two separated nuclear targets (see Fig.~\subref*{fig:spatial}). The magnetic field rotations can be then chosen independently of each other. Analogously to the first approach, the switching  times can then be optimized individually for each input polarization state potentially leading to theoretical probabilities of realization larger than 95\%. The two spatially separated paths are later on recombined via a beam mixer BM \cite{Roseker2011.time-delay}.

So far we have restricted ourselves to the case where the incoming photon has been either $\sigma$- or $\pi$-polarized. What about single-photon states being initially in a quantum mechanical superposition of $\sigma$ and $\pi$? Are the logical gates still working for such superposition states? In order to answer these questions, let us consider the superposition
%
\begin{equation}
\ketm{\Psi} = \alpha \ketm{\sigma} + \beta \ketm{\pi}\ ,
\end{equation}
%
where \ket{\sigma} and \ket{\pi} denotes a $\sigma$- and $\pi$-polarized state, respectively, and $\alpha$ and $\beta$ are some arbitrary complex amplitudes. Following the notation of Chaps.~\ref{chap:NFS} and \ref{chap:pol-control}, \ket{\Psi} represents the incoming radiation and can be written as 
%
\begin{equation}
\bm{E}_{\rm{in}}(\tau) = \big( \alpha \bm{e}_{\sigma} + \beta \bm{e}_{\pi} \big) \delta(\tau)\ .
\label{eq:super-input}
\end{equation}
%
In the following, we will evaluate how the scattered radiation field looks like for an input state given in Eq.~\eqref{eq:super-input}. In order to do so, we first have a look at the single scattering amplitude $\bm{E}^{(1)}$ which is completely determined by $\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{I}}$ for $\tau<\tau_0$ and $\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{II}}$ for $\tau>\tau_0$. Inserting Eq.~\eqref{eq:super-input} into Eq.~\eqref{eq:amplitude-I} and Eq.~\eqref{eq:amplitude-II}, respectively, leads to
%
\begin{align}
\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{I}}(\bm{k}) &= \bm{j}_{\ell,\mathrm{I}}(\bm{k}) \left( \bm{j}_{\ell,\mathrm{I}}^{*}(\bm{k}) \cdot \Big( \alpha \bm{e}_{\sigma} + \beta \bm{e}_{\pi} \Big) \right) \nonumber \\
&= \alpha {\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{I}}}^{\sigma}(\bm{k}) + \beta {\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{I}}}^{\pi}(\bm{k})
\label{eq:super-A1-I}
\end{align}
%
and
%
\begin{align}
\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{II}}(\bm{k}) &= \bm{j}_{\ell,\rm{II}}(\bm{k}) \sum_{\ell'} \e^{-\i \Omega_{\ell} \tau_0}  \mathcal{D}_{M _{\rm{g}}M _{\rm{g}}'}^{I _{\rm{g}}}(\alpha,\beta,\gamma) \mathcal{D}_{M _{\rm{e}}M _{\rm{e}}'}^{I _{\rm{e}} \,*}(\alpha,\beta,\gamma) \nonumber \\
& \qquad \times
\int_{0}^{\tau_0} \d\tau'\, \bm{J}_{\ell',\mathrm{I}}^{*}(\bm{k},\tau') \cdot \big( \alpha \bm{e}_{\sigma} + \beta \bm{e}_{\pi} \big) \delta(\tau')  \nonumber \\
&= \alpha {\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{II}}}^{\sigma}(\bm{k}) + \beta {\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{II}}}^{\pi}(\bm{k})\ .
\end{align}
%
In both cases, the amplitudes split up into a part determined by the $\sigma$-component of the incoming x-ray pulse $\bm{E}_{\rm{in}}$ and a part originating from the $\pi$-component of $\bm{E}_{\rm{in}}$. In order to obtain a similar decomposition of the second order amplitudes $\bm{\mathcal{A}}^{(2)}_{\ell,\mathrm{II}}(\bm{k})$, Eq.~\eqref{eq:field-I} is used to express $\bm{E}^{(1)}$ in terms of the amplitudes $\bm{\mathcal{A}}^{(1)}_{\ell,\mathrm{I}}$ for $\tau<\tau_0$. Inserting subsequently Eq.~\eqref{eq:super-A1-I} into Eq.~\eqref{eq:field-I} and then into Eq.~\eqref{eq:amplitude-xi-independent} leads directly to
%
\begin{align}
\bm{\mathcal{A}}^{(2)}_{\ell,\mathrm{II}}(\bm{k}) &= \bm{j}_{\ell,\rm{II}}(\bm{k}) \sum_{\ell'} \e^{-\i \Omega_{\ell} \tau_0}  \mathcal{D}_{M _{\rm{g}}M _{\rm{g}}'}^{I _{\rm{g}}}(\alpha,\beta,\gamma) \mathcal{D}_{M _{\rm{e}}M _{\rm{e}}'}^{I _{\rm{e}} \,*}(\alpha,\beta,\gamma) \nonumber \\
& \qquad \times
\int_{0}^{\tau_0} \d\tau'\, \bm{J}_{\ell',\mathrm{I}}^{*}(\bm{k},\tau') \cdot \sum_{\ell''} \big( \alpha {\bm{\mathcal{A}}^{(1)}_{\ell'',\mathrm{I}}}^{\sigma}(\bm{k}) + \beta {\bm{\mathcal{A}}^{(1)}_{\ell'',\mathrm{I}}}^{\pi}(\bm{k}) \big) \, \e^{-\i \Omega_{\ell''} \tau' - \tau'/2}  \nonumber \\
&= \alpha {\bm{\mathcal{A}}^{(2)}_{\ell,\mathrm{II}}}^{\sigma}(\bm{k}) + \beta {\bm{\mathcal{A}}^{(2)}_{\ell,\mathrm{II}}}^{\pi}(\bm{k}) \ .
\end{align}
%
It can be analogously shown that higher orders decompose in the same way finally resulting in
%
\begin{equation}
\bm{\mathcal{A}}_{\ell,\mathrm{II}}(\bm{k},\xi) = \alpha \bm{\mathcal{A}}_{\ell,\mathrm{II}}^{\sigma}(\bm{k},\xi) + \beta \bm{\mathcal{A}}_{\ell,\mathrm{II}}^{\pi}(\bm{k},\xi)\ .
\end{equation}
%
Since moreover the amplitudes $\bm{\mathcal{B}}_{\ell,\mathrm{II}}$, $\bm{\mathcal{C}}_{\ell,\mathrm{II}}$, etc., can be written in this form, the total scattered field amplitude splits up in the same manner.
For instance, the contribution $\bm{E}_0$ without nuclear scattering events after $\tau_0$ can be explicitly written as 
%
\begin{equation}
\bm{E}_0(\xi,\tau) = \alpha \bm{E}_0^{\sigma}(\xi,\tau) + \beta \bm{E}_0^{\pi}(\xi,\tau) \ ,
\label{eq:super-field}
\end{equation}
%
where the superscript $\sigma$ ($\pi$) indicates that this contribution originates solely from the initially $\sigma$-($\pi$-)polarized component. Note that $\bm{E}_0^{\sigma}$ and $\bm{E}_0^{\pi}$ in general have arbitrary polarization depending on the scattering events prior to $\tau_0$.

What does this mean for the initial superposition state \ket{\Psi}? Since the total scattered field amplitude splits up into a part coming from \ket{\sigma} and a part coming from \ket{\pi}, the proposed processing schemes for single x-rays can be applied to arbitrary superposition states. The gate transformations can be explicitly generalized to
%
\begin{align}
\textsc{Identity:}& \quad \ketm{\Psi} \to \alpha \,\psi^{\sigma}_{\rm{id}}(t) \ketm{\sigma} +  \beta \,\psi^{\pi}_{\rm{id}}(t) \ketm{\pi}\ , \nonumber \\
\textsc{False:}& \quad \ketm{\Psi} \to \alpha \,\psi^{\sigma}_{\rm{false}}(t) \ketm{\pi} +  \beta \,\psi^{\pi}_{\rm{false}}(t) \ketm{\pi}\ , \nonumber \\
\textsc{True:}& \quad  \ketm{\Psi} \to \alpha \,\psi^{\sigma}_{\rm{true}}(t) \ketm{\sigma} + \beta \,\psi^{\pi}_{\rm{true}}(t) \ketm{\sigma}\ , \nonumber \\
\textsc{Negation:}& \quad \ketm{\Psi} \to \alpha \,\psi^{\sigma}_{\rm{neg}}(t) \ketm{\pi} +  \beta \,\psi^{\pi}_{\rm{neg}}(t) \ketm{\sigma}\ .
\label{eq:super-final}
\end{align}
%
Here, the time-dependent scattering amplitudes $\psi$ describe the resonant scattering process after the magnetic field rotation ($\tau>\tau_0$). Small perturbations from the ``wrong'' polarization state due to scattering events after $\tau_0$ involve higher orders $\bm{E}_n$ and have been neglected in Eqs.~\eqref{eq:super-final}. The amplitudes $\psi$ are determined via Eq.~\eqref{eq:super-field} where only the $0^{\rm{th}}$ order $\bm{E}_0$ (after $\tau_0$) is taken into account.




%------------------------------------------------------------------------------------%
\section{Boolean algebra with x-rays}
\label{sec:binary-gates}


We now turn to the implementation of Boolean operations with x-rays by means of binary logical gates. Since the x-ray-nuclear interface hosts a single photon only,  a second, temporally synchronized photon is required as control. A simple but elegant idea to induce an effective nonlinearity between control and target photons is to have the magnetic field rotation triggered by the detection of the second control photon \cite{Jonas2015-gates-arxiv}. The latter can be spatially separated from the x-ray line as shown in Fig.~\ref{fig:gates-setup} in order to distinguish between control and target mode. Since the nature of the implemented logical operation is completely determined by $\tau_0$, the trigger photon responsible for the magnetic field switching acts as control for the polarization-encoded x-ray. 

The magnetic field rotation could be applied at a predetermined switching time $\tau_0$ (counted from the incidence of the x-ray target pulse at $\tau=0$), in case a control photon is detected at the trigger. Alternatively, the detection event of the control photon may trigger a prompt  rotation of the magnetic field. In this case the switching instant $\tau_0$ is no longer predetermined but rather set during operation, and coincides with  the incidence of the control photon at the trigger.
In the following, we consider the latter, more general procedure where the moment $\tau_0$ is determined during operation. 
%It will turn out that in some cases the switching scheme can be reduced such that the practical implementation is feasible by the simplified procedure with a predetermined switching instant.


\begin{figure}%
\centering
\includegraphics[width=0.75\linewidth]{pics/pulse-sequence.pdf}
\caption{Time sequence of target and control pulse. A time delay $\Delta \tau$ between target and control pulse is introduced. The $\pi$-polarized component of the control pulse (blue) is furthermore delayed by $\Delta \tau_0$ with respect to the $\sigma$-polarized component (orange).}
\label{fig:pulse-sequence}
\end{figure}


The control photon is considered to be temporally synchronized with the target pulse exhibiting a time delay $\Delta\tau$ (see Fig.~\ref{fig:pulse-sequence}). In order to render the triggering process dependent on the polarization of the control path, a polarization-sensitive element such as a polarizer can be used. We consider two kind of procedures: (i) the polarizer is placed in front of the trigger such that only photons of a certain polarization reach the detector which activates the magnetic field rotation; (ii) the polarizer is embedded into a time delay line as illustrated in Fig.~\ref{fig:time} in order to obtain an arrival time of the control pulse at the trigger sensitive to its polarization. In the latter case, either the $\sigma$- or $\pi$-component is delayed in comparison to its orthogonal counterpart by a time period $\Delta\tau_0$. The resulting pulse sequence with the corresponding time delays $\Delta\tau$ and $\Delta\tau_0$ is sketched in Fig.~\ref{fig:pulse-sequence} for the case where the $\pi$-component experiences a time shift with respect to the $\sigma$-polarized part. Note that whenever procedure (i) is applicable or $\Delta\tau_0=0$, the switching scheme can be reduced such that the practical implementation is feasible by the simplified triggering procedure with a predetermined switching instant $\tau_0$.

In the following, we discuss on the canonical example of the exclusive OR (XOR) how Boolean operations can be physically implemented with x-ray photons. The truth table of the XOR operation is given in Table \ref{table:bin-gates}, the output is ``T'' if and only if control and target photons are in opposite states. In general, the control photon may encode information for instance in polarization, time bin \cite{Physics.time-bins, Humphreys2013.PRL, Donohue2013.PRL}, or path. We employ the same information encoding as for the target x-ray photon where ``F'' and ``T'' are encoded as $\pi$- and $\sigma$-polarized states, respectively. In the case of the XOR, the NFS setup is required to operate as \textsc{Identity} if the control photon is $\sigma$-polarized $C=\pi$ and as \textsc{Negation} if $C=\sigma$. This can be explicitly implemented by a time delay of the control pulse $\Delta\tau=22.3$~ns (see Table \ref{table:bin-gates}) and by a polarizer allowing only $\sigma$-polarized photons to reach the trigger (illustrated as ``$\times$'' in Table \ref{table:bin-gates}). The timed magnetic field rotation then results in a flip of the polarization of the target photon if $C=\sigma$. If $C=\pi$, no magnetic field rotation is applied leaving the polarization untouched. 



\newlength{\Lprocedure}
\settowidth{\Lprocedure}{\textsc{Negation} \textit{if} $C=\sigma$}
\newlength{\Ldelay}
\settowidth{\Ldelay}{delay $\Delta \tau_0$}
\renewcommand{\arraystretch}{1.2}
\begin{table}
  \small
  \centering
\begin{tabular}{lccccc}
\hline\hline
  & & & & \tabularnewline[-0.4cm]
Operation & Implementation & Time delay $\Delta \tau$ & \multicolumn{2}{c}{Time delay $\Delta \tau_0$} & Truth table \tabularnewline
  & & & $\pi$ & $\sigma$ & \tabularnewline
  & & & & \tabularnewline[-0.4cm] \hline
  & & & & \tabularnewline[-0.1cm]
FALSE & \parbox{\Lprocedure}{\centering {\textsc{False} \textit{if} $C=\pi$}\\ \textsc{False} \textit{if} $C=\sigma$} & 53.7 ns &  &  & 
\renewcommand{\arraystretch}{1}
\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{F} \\
\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{F}
\end{tabular}
\renewcommand{\arraystretch}{1.2}
\tabularnewline[0.7cm]
AND & \parbox{\Lprocedure}{\centering {\textsc{False} \textit{if} $C=\pi$}\\ \textsc{Identity} \textit{if} $C=\sigma$} & 53.7 ns &  & $\times$ & 
\renewcommand{\arraystretch}{1}
\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{F} \\
\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{T}
\end{tabular}
\renewcommand{\arraystretch}{1.2}
\tabularnewline[0.7cm]
NAND & \parbox{\Lprocedure}{\centering {\textsc{True} \textit{if} $C=\pi$}\\ \textsc{Negation} \textit{if} $C=\sigma$} & 22.3 ns & & 9.3 ns & 
\renewcommand{\arraystretch}{1}
\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{T} \\
\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{F}
\end{tabular}
\renewcommand{\arraystretch}{1.2}
\tabularnewline[0.7cm]
OR & \parbox{\Lprocedure}{\centering {\textsc{Identity} \textit{if} $C=\pi$}\\ \textsc{True} \textit{if} $C=\sigma$} & 31.6 ns & $\times$ & & 
\renewcommand{\arraystretch}{1}
\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{T} \\
\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{T}
\end{tabular}
\renewcommand{\arraystretch}{1.2}
\tabularnewline[0.7cm]
NOR & \parbox{\Lprocedure}{\centering {\textsc{Negation} \textit{if} $C=\pi$}\\ \textsc{False} \textit{if} $C=\sigma$} & 22.3 ns & 31.4 ns & & 
\renewcommand{\arraystretch}{1}
\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{F} \\
\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{F}
\end{tabular}
\renewcommand{\arraystretch}{1.2}
\tabularnewline[0.7cm]
XOR & \parbox{\Lprocedure}{\centering {\textsc{Identity} \textit{if} $C=\pi$}\\ \textsc{Negation} \textit{if} $C=\sigma$} & 22.3 ns & $\times$ & & 
\renewcommand{\arraystretch}{1}
\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{T} \\
\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{F}
\end{tabular}
\renewcommand{\arraystretch}{1.2}
\tabularnewline[0.7cm]
XNOR & \parbox{\Lprocedure}{\centering {\textsc{Negation} \textit{if} $C=\pi$}\\ \textsc{Identity} \textit{if} $C=\sigma$} & 22.3 ns & & $\times$ & 
\renewcommand{\arraystretch}{1}
\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{F} \\
\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{T}
\end{tabular}
\renewcommand{\arraystretch}{1.2}
\tabularnewline[0.7cm]
%if/then & \parbox{2.7cm}{\centering {\textsc{Identity} \textit{if} $C=\sigma$}\\ \textsc{Identity} \textit{if} $C=\sigma$} & 10 ns & 10 ns & 
%\renewcommand{\arraystretch}{1}
%\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
%\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
%\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{F} \\
%\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{T}
%\end{tabular}
%\renewcommand{\arraystretch}{1.2}
%\tabularnewline[0.7cm]
%then/if & \parbox{2.7cm}{\centering {\textsc{Identity} \textit{if} $C=\sigma$}\\ \textsc{Identity} \textit{if} $C=\sigma$} & 10 ns & 10 ns & 
%\renewcommand{\arraystretch}{1}
%\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
%\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
%\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{T} \\
%\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{F} &  \cellcolor{fore} \textcolor{back}{T}
%\end{tabular}
%\renewcommand{\arraystretch}{1.2}
%\tabularnewline[0.7cm]
TRUE & \parbox{\Lprocedure}{\centering \textsc{True} \textit{if} $C=\pi$\\ \textsc{True} \textit{if} $C=\sigma$} & 31.6 ns & & & 
\renewcommand{\arraystretch}{1}
\begin{tabular}{C{0.15cm} C{0.15cm} C{0.15cm}}
\rowcolor{back} & \textcolor{fore}{\textbf{F}} & \textcolor{fore}{\textbf{T}} \\ 
\cellcolor{back} \textcolor{fore}{\textbf{F}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{T} \\
\cellcolor{back} \textcolor{fore}{\textbf{T}} & \cellcolor{fore} \textcolor{back}{T} &  \cellcolor{fore} \textcolor{back}{T}
\end{tabular}
\renewcommand{\arraystretch}{1.2}
\tabularnewline[0.7cm]
  & & & & \tabularnewline[-0.4cm] \hline\hline
\end{tabular}
\caption{Boolean operations with two inputs. The implementation of the commutative, binary logical operations is shown including the corresponding control pulse delay $\tau$, polarization delay $\tau_0$ and condensed truth tables. The following optimized moments of switching have been considered for the unary gates: $\tau_0 = 53.7$~ns for \textsc{False}, $\tau_0 = 31.6$~ns for \textsc{True} and $\tau_0 = 22.3$~ns for \textsc{Negation}.}
\label{table:bin-gates}
\end{table}
\renewcommand{\arraystretch}{1}



In Table \ref{table:bin-gates} possible implementations for the commutative Boolean operations with two inputs are summarized by means of a pulse sequence determined by $\Delta\tau$ and $\Delta\tau_0$. For $\Delta\tau_0$ we distinguish if either the $\pi$- or $\sigma$-polarization component is delayed. Moreover, the ``$\times$'' indicates that the corresponding polarization component is removed by a polarizer such that it does not reach the trigger. Each time a ``$\times$'' appears or $\Delta\tau_0=0$, the operation can be practically realized with a predetermined switching instant. For instance, in the case of the XOR operation, a predetermined switching moment of 22.3~ns can be used if it is ensured that only $\sigma$-polarized control photons reach the trigger.

The XOR operation is the classical counterpart to a controlled NOT (CNOT) gate. The CNOT gate flips the state of a target qubit conditional on a control (C) qubit being in the logical state ``T'' \cite{NielsenChuang2000}. Since the information associated with the control photon is destroyed during operation in our setup, and the polarization control relies on resonant scattering, the presented setup corresponds to a nondeterministic version of a destructive CNOT gate \cite{Pittman2001.PRA,Pittman2002.PRL}, which cannot be used directly for reversible computing \cite{OBrien2007.S}. Two-photon interference phenomena like the Hong-Ou-Mandel effect \cite{Hong-Ou-Mandel} may be employed to build real non-destructive quantum gates in the x-ray domain.
%However, provided copies of the target photon can be made, also a non-destructive CNOT gate can be accomplished. In the optical regime, this is achieved by harnessing quantum teleportation \cite{Bennett.1993.PRL}.

A proof-of-principle experiment for the operation of Boolean algebra with x-rays can be carried out already today at SR facilities which have access to the keV photon energy regime and short pulses ($\sim$~ps) compared to the time-scale of the nuclear response ($\sim$~ns). Moreover, the high pulse repetition rate renders it possible to record the presented intensity spectra in a reasonable time. The magnetic field rotation can be triggered by the detection of the control photon temporally synchronized with the synchrotron pulse clock. A fast triggering process is guaranteed by todays photodiodes which have response times shorter than 1~ns \cite{Seely2002.photodiode, Keister2010.photodiode}. A tilt of the polarization plane of the scattered x-rays can be measured with a precision down to a few arcsec by using a special polarizer-analyzer setup \cite{Marx2013.polarizer}. Experiments at novel x-ray free electron sources (with their high brightness) \cite{LCLS-web,SACLA-web} will facilitate the implementation of binary x-ray gates where both target and control photons are resonant to the nuclear transitions and originate from the same x-ray pulse. 

In conclusion, we have shown that the light-nucleus interaction in NFS can be used to perform logical operations on single x-ray photons  by applying  nuclear hyperfine magnetic field rotations. X-ray single-input gates can be compiled within a single setup where solely the variation of the magnetic field switching moment $\tau_0$ determines the nature of the logical operation. The introduction of a temporally synchronized control photon allows to design a triggering procedure along which Boolean operations with two input states can be performed. The realization of these basic logical operations may extend information science to photon energies in the x-ray domain in the near future involving potential spatial resolutions on the scale of single atoms.












